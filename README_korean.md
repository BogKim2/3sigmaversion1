# DCR Format Converter (한글 사용 설명서)

**버전:** 1.0  
**개발자:** 김상우 (Sangwoo Kim)  
**기술 지원:** Opus 4.5 및 Gemini 협업 개발  
**기업 아이덴티티:** Sumitomo Electric Industries (SEI) 브랜드 표준 적용

---

## 1. 프로그램 개요 (Overview)

**DCR Format Converter**는 전자 부품의 측정 데이터를 자동으로 변환, 처리 및 통계 분석하기 위한 전문 데스크톱 애플리케이션입니다. **Python**과 **PySide6**를 기반으로 구축되었으며, Sumitomo Blue 기업 컬러를 활용한 현대적인 **Material Design** 인터페이스를 제공합니다.

이 프로그램은 복잡한 `.NET` 및 `.xlsx` 원천 파일을 표준화된 Excel 보고서로 변환하고, 고속 통계 계산을 수행하며, 자동화된 판정 로직이 포함된 결과 파일을 생성하여 업무 효율을 극대화합니다.

---

## 2. 주요 기능 상세

### 탭 1: DCR 포맷 생성 (`make DCR format`)
회로망 데이터(Netlist)와 벤더 사양서를 통합하여 표준 DCR(직류 저항) 포맷을 생성합니다.
- **입력 처리**: `.NET` 파일 및 벤더/파트핀 사양 Excel 파일을 파싱합니다.
- **자동 시트 생성**:
  - `vendor`: 벤더 사양 포맷팅 및 자동 수식 삽입.
  - `DE requirement`: 파트핀 파일에서 연속성 데이터 추출 및 주소 매핑.
  - `input check pin`: Netlist의 `#4W` 섹션과 회로 요구사항 병합.
  - `Judge(check pin)`: 핀 구성에 대한 합격/불합격 판정 로직 생성.
  - `DCR`: 구조화된 Net 이름과 그룹 핀이 포함된 최종 통합 보고서.

### 탭 2: 양식 측정 보고서 생성 (`make Form Measurement Result file`)
템플릿을 기반으로 고정밀 측정 데이터를 채워 표준화된 보고서를 생성합니다.
- **데이터 통합**:
  - **TDR 데이터**: 선택한 디렉토리 내의 여러 DK 파일에서 TDR 데이터를 자동으로 추출합니다.
  - **치수 분석**: 치수 관련 Excel 보고서에서 회로 폭 및 두께 데이터를 추출합니다.
  - **스펙 매핑**: 마스터 스펙 파일에서 LSL, Center, USL 값을 가져옵니다.
- **스마트 포맷팅**: 조건부 서식(OK: 녹색, NG: 빨간색) 및 자동 필터 기능을 모든 데이터 열에 적용합니다.

### 탭 3: 통계적 LSL/USL 계산 (`calculate LSL USL`)
대규모로 통합된 측정 파일에 대해 고급 통계 분석을 수행합니다.
- **고성능 처리**: 수만 개의 데이터 포인트를 분석하여 재배열합니다.
- **통계 패키지**: Min, Max, Average, Median, Stdev, IQR 및 이상치 임계값(1stQuat-4IQR, 3rdQuat+4IQR)을 계산합니다.
- **하이브리드 계산 엔진**: 복잡한 필터링 및 통계 계산은 Python에서 수행하여 속도를 높이고, 최종 결과물에는 Excel 수식을 유지하여 유연성을 확보합니다.
- **최종 출력**: `Calculate_3Sigma_LSLUSL_final.xlsx`를 생성합니다.

### 엔터프라이즈 부가 기능
- **전체 자동 실행 (Auto Execute All)**: 단 한 번의 클릭으로 탭 1부터 탭 3까지의 모든 과정을 순차적으로 수행합니다.
- **통합 로깅 시스템**: 실시간 진행 상황을 화면에 표시하고, 작업 완료 후 자동으로 `.dat` 로그 파일로 저장합니다.
- **자동 표지 (Cover Page)**: 생성되는 모든 Excel 파일의 첫 번째 시트에 프로그램 버전, 작업자, 생성 일시, 입출력 파일 경로 등의 감사 추적 정보를 포함한 전문적인 표지를 생성합니다.

---

## 3. 사용 방법 (Operating Guide)

1.  **작업자 등록**: 첫 번째 탭에서 **Operator Name**을 입력합니다. 이 이름은 파일명, 표지, 로그 파일에 기록됩니다.
2.  **파일 선택**: 각 탭의 **Browse** 버튼을 사용하여 필요한 입력 파일들을 선택합니다.
3.  **실행**:
    - 특정 작업만 필요한 경우 각 탭의 **Execute** 버튼을 클릭합니다.
    - 전체 공정이 필요한 경우 상단의 **Auto Execute All** 버튼을 클릭합니다.
4.  **로그 확인**: 하단의 로그 창을 통해 실시간 진행 상황을 모니터링합니다. 완료 후 `output` 폴더에 생성된 로그 파일을 확인합니다.
5.  **결과 확인**: `output` 폴더에 생성된 Excel 파일들을 열어 결과와 판정 내용을 확인합니다.

---

## 4. 파일 및 폴더 규칙

### 출력 경로
모든 결과물은 프로그램 실행 위치의 **`output/`** 폴더 내에 저장됩니다.

### 파일 명칭 규칙
- **DCR 포맷**: `DCR_format_yamaha_{작업자}_{날짜}.xlsx`
- **측정 보고서**: `Form_measurement_result_{작업자}_{날짜}.xlsx`
- **최종 통계**: `Calculate_3Sigma_LSLUSL_final.xlsx`
- **로그 파일**: `log_{작업자}_{날짜}.dat`

---

## 5. 기술 사양 및 주의사항

- **데이터 무결성**: 숫자로 변환 가능한 데이터는 자동으로 수치화하며, 텍스트 데이터도 유실 없이 보존합니다.
- **표준화**: **GND-SUS** 항목은 기업 표준에 따라 LSL: **0**, USL: **50**으로 자동 고정됩니다.
- **설정 저장**: 입력했던 파일 경로와 작업자 이름은 **`files.json`**에 자동으로 저장되어 다음 실행 시 재입력할 필요가 없습니다.
- **보안**: 본 도구는 Sumitomo Electric Industries 내부 환경에서 사용하도록 설계되었습니다.

---
*최종 업데이트: 2026년 1월 8일*

